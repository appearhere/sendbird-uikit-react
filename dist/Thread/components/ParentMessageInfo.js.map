{"version":3,"file":"ParentMessageInfo.js","sources":["../../../src/smart-components/Thread/components/ParentMessageInfo/index.tsx"],"sourcesContent":["import React, { useContext, useEffect, useRef, useState } from 'react';\nimport format from 'date-fns/format';\nimport { FileMessage, UserMessage } from '@sendbird/chat/message';\nimport { Role } from '@sendbird/chat';\n\nimport './index.scss';\nimport RemoveMessage from '../RemoveMessageModal';\nimport ParentMessageInfoItem from './ParentMessageInfoItem';\n\nimport {\n  getSenderName,\n} from '../../../../utils';\nimport { useLocalization } from '../../../../lib/LocalizationContext';\nimport useSendbirdStateContext from '../../../../hooks/useSendbirdStateContext';\nimport { useThreadContext } from '../../context/ThreadProvider';\nimport { UserProfileContext } from '../../../../lib/UserProfileContext';\nimport SuggestedMentionList from '../../../Channel/components/SuggestedMentionList';\n\nimport Avatar from '../../../../ui/Avatar';\nimport Label, { LabelTypography, LabelColors } from '../../../../ui/Label';\nimport FileViewer from '../../../../ui/FileViewer';\nimport MessageItemMenu from '../../../../ui/MessageItemMenu';\nimport MessageItemReactionMenu from '../../../../ui/MessageItemReactionMenu';\nimport ContextMenu, { MenuItems } from '../../../../ui/ContextMenu';\nimport ConnectedUserProfile from '../../../../ui/UserProfile';\nimport { UserProfileContextInterface } from '../../../../ui/MessageContent';\nimport MessageInput from '../../../../ui/MessageInput';\nimport { MessageInputKeys } from '../../../../ui/MessageInput/const';\n\nexport interface ParentMessageInfoProps {\n  className?: string;\n}\n\nexport default function ParentMessageInfo({\n  className,\n}: ParentMessageInfoProps): React.ReactElement {\n  const { stores, config } = useSendbirdStateContext();\n  const {\n    isMentionEnabled,\n    isReactionEnabled,\n    replyType,\n    isOnline,\n    userMention,\n  } = config;\n  const userId = stores?.userStore?.user?.userId;\n  const { dateLocale } = useLocalization?.();\n  const {\n    currentChannel,\n    parentMessage,\n    allThreadMessages,\n    emojiContainer,\n    toggleReaction,\n    updateMessage,\n    deleteMessage,\n    onMoveToParentMessage,\n    onHeaderActionClick,\n    isMuted,\n    isChannelFrozen,\n  } = useThreadContext();\n\n  const [showRemove, setShowRemove] = useState(false);\n  const [supposedHover, setSupposedHover] = useState(false);\n  const [showFileViewer, setShowFileViewer] = useState(false);\n  const usingReaction = isReactionEnabled && !currentChannel?.isSuper && !currentChannel?.isBroadcast\n\n  // Edit message\n  const [showEditInput, setShowEditInput] = useState(false);\n  const disabled = !isOnline || isMuted || isChannelFrozen && !(currentChannel?.myRole === Role.OPERATOR);\n\n  // Mention\n  const editMessageInputRef = useRef(null);\n  const [mentionNickname, setMentionNickname] = useState('');\n  const [mentionedUsers, setMentionedUsers] = useState([]);\n  const [mentionedUserIds, setMentionedUserIds] = useState([]);\n  const [messageInputEvent, setMessageInputEvent] = useState(null);\n  const [selectedUser, setSelectedUser] = useState(null);\n  const [mentionSuggestedUsers, setMentionSuggestedUsers] = useState([]);\n  const [ableMention, setAbleMention] = useState(true);\n  const displaySuggestedMentionList = isOnline\n    && isMentionEnabled\n    && mentionNickname.length > 0\n    && !isMuted\n    && !(isChannelFrozen && !(currentChannel.myRole === Role.OPERATOR));\n  useEffect(() => {\n    if (mentionedUsers?.length >= userMention?.maxMentionCount) {\n      setAbleMention(false);\n    } else {\n      setAbleMention(true);\n    }\n  }, [mentionedUsers]);\n  useEffect(() => {\n    setMentionedUsers(mentionedUsers.filter(({ userId }) => {\n      const i = mentionedUserIds.indexOf(userId);\n      if (i < 0) {\n        return false;\n      } else {\n        mentionedUserIds.splice(i, 1);\n        return true;\n      }\n    }));\n  }, [mentionedUserIds]);\n\n  // User Profile\n  const avatarRef = useRef(null);\n  const {\n    disableUserProfile,\n    renderUserProfile,\n  } = useContext<UserProfileContextInterface>(UserProfileContext);\n\n  if (showEditInput && parentMessage?.isUserMessage?.()) {\n    return (\n      <>\n        {\n          displaySuggestedMentionList && (\n            <SuggestedMentionList\n              className=\"parent-message-info--suggested-mention-list\"\n              targetNickname={mentionNickname}\n              inputEvent={messageInputEvent}\n              // renderUserMentionItem={renderUserMentionItem}\n              onUserItemClick={(user) => {\n                if (user) {\n                  setMentionedUsers([...mentionedUsers, user]);\n                }\n                setMentionNickname('');\n                setSelectedUser(user);\n                setMessageInputEvent(null);\n              }}\n              onFocusItemChange={() => {\n                setMessageInputEvent(null);\n              }}\n              onFetchUsers={(users) => {\n                setMentionSuggestedUsers(users);\n              }}\n              ableAddMention={ableMention}\n              maxMentionCount={userMention?.maxMentionCount}\n              maxSuggestionCount={userMention?.maxSuggestionCount}\n            />\n          )\n        }\n        <MessageInput\n          isEdit\n          disabled={disabled}\n          ref={editMessageInputRef}\n          mentionSelectedUser={selectedUser}\n          isMentionEnabled={isMentionEnabled}\n          message={parentMessage}\n          onStartTyping={() => {\n            currentChannel?.startTyping?.();\n          }}\n          onUpdateMessage={({ messageId, message, mentionTemplate }) => {\n            updateMessage({\n              messageId,\n              message,\n              mentionedUsers,\n              mentionTemplate,\n            });\n            setShowEditInput(false);\n            currentChannel?.endTyping?.();\n          }}\n          onCancelEdit={() => {\n            setMentionNickname('');\n            setMentionedUsers([]);\n            setMentionedUserIds([]);\n            setMentionSuggestedUsers([])\n            setShowEditInput(false);\n            currentChannel?.endTyping?.();\n          }}\n          onUserMentioned={(user) => {\n            if (selectedUser?.userId === user?.userId) {\n              setSelectedUser(null);\n              setMentionNickname('');\n            }\n          }}\n          onMentionStringChange={(mentionText) => {\n            setMentionNickname(mentionText);\n          }}\n          onMentionedUserIdsUpdated={(userIds) => {\n            setMentionedUserIds(userIds);\n          }}\n          onKeyDown={(e) => {\n            if (displaySuggestedMentionList && mentionSuggestedUsers?.length > 0\n              && ((e.key === MessageInputKeys.Enter && ableMention) || e.key === MessageInputKeys.ArrowUp || e.key === MessageInputKeys.ArrowDown)\n            ) {\n              setMessageInputEvent(e);\n              return true;\n            }\n            return false;\n          }}\n        />\n      </>\n    );\n  }\n\n  return (\n    <div className={`sendbird-parent-message-info ${className}`}>\n      <ContextMenu\n        menuTrigger={(toggleDropdown) => (\n          <Avatar\n            className=\"sendbird-parent-message-info__sender\"\n            ref={avatarRef}\n            src={\n              currentChannel?.members?.find((m) => m?.userId === parentMessage?.sender?.userId)?.profileUrl\n              || parentMessage?.sender?.profileUrl\n            }\n            alt=\"thread message sender\"\n            width=\"40px\"\n            height=\"40px\"\n            onClick={() => {\n              if (!disableUserProfile) {\n                toggleDropdown();\n              }\n            }}\n          />\n        )}\n        menuItems={(closeDropdown) => (\n          <MenuItems\n            parentRef={avatarRef}\n            parentContainRef={avatarRef}\n            closeDropdown={closeDropdown}\n            style={{ paddingTop: '0px', paddingBottom: '0px' }}\n          >\n            {renderUserProfile\n              ? renderUserProfile({ user: parentMessage?.sender, close: closeDropdown })\n              : (\n                <ConnectedUserProfile\n                  user={parentMessage?.sender}\n                  currentUserId={userId}\n                  onSuccess={closeDropdown}\n                />\n              )}\n          </MenuItems>\n        )}\n      />\n      <div className=\"sendbird-parent-message-info__content\">\n        <div className=\"sendbird-parent-message-info__content__info\">\n          <Label\n            className={`sendbird-parent-message-info__content__info__sender-name${usingReaction ? '--use-reaction' : ''}`}\n            type={LabelTypography.CAPTION_2}\n            color={LabelColors.ONBACKGROUND_2}\n          >\n            {\n              currentChannel?.members?.find((member) => member?.userId === parentMessage?.sender?.userId)\n                ?.nickname || getSenderName?.(parentMessage as UserMessage | FileMessage)\n            }\n          </Label>\n          <Label\n            className=\"sendbird-parent-message-info__content__info__sent-at\"\n            type={LabelTypography.CAPTION_3}\n            color={LabelColors.ONBACKGROUND_2}\n          >\n            {format(parentMessage?.createdAt || 0, 'p', { locale: dateLocale })}\n          </Label>\n        </div>\n        {/* message content body */}\n        <ParentMessageInfoItem\n          message={parentMessage}\n          showFileViewer={setShowFileViewer}\n        />\n      </div>\n      {/* context menu */}\n      <MessageItemMenu\n        className={`sendbird-parent-message-info__context-menu ${usingReaction ? 'use-reaction' : ''} ${supposedHover ? 'sendbird-mouse-hover' : ''}`}\n        channel={currentChannel}\n        message={parentMessage}\n        isByMe={userId === parentMessage?.sender?.userId}\n        disableDeleteMessage={allThreadMessages.length > 0}\n        replyType={replyType}\n        showEdit={setShowEditInput}\n        showRemove={setShowRemove}\n        setSupposedHover={setSupposedHover}\n        onMoveToParentMessage={() => {\n          onMoveToParentMessage({ message: parentMessage, channel: currentChannel });\n        }}\n      />\n      {usingReaction && (\n        <MessageItemReactionMenu\n          className={`sendbird-parent-message-info__reaction-menu ${supposedHover ? 'sendbird-mouse-hover' : ''}`}\n          message={parentMessage}\n          userId={userId}\n          emojiContainer={emojiContainer}\n          toggleReaction={toggleReaction}\n          setSupposedHover={setSupposedHover}\n        />\n      )}\n      {showRemove && (\n        <RemoveMessage\n          onCancel={() => setShowRemove(false)}\n          onSubmit={() => {\n            onHeaderActionClick?.();\n          }}\n          message={parentMessage}\n        />\n      )}\n      {showFileViewer && (\n        <FileViewer\n          message={parentMessage as FileMessage}\n          onClose={() => setShowFileViewer(false)}\n          onDelete={() => {\n            deleteMessage(parentMessage)\n              .then(() => {\n                setShowFileViewer(false);\n              });\n          }}\n        />\n      )}\n    </div>\n  );\n}\n"],"names":["ParentMessageInfo","_a","className","_h","useSendbirdStateContext","stores","config","isMentionEnabled","isReactionEnabled","replyType","isOnline","userMention","userId","_c","_b","userStore","user","dateLocale","useLocalization","_j","useThreadContext","currentChannel","parentMessage","allThreadMessages","emojiContainer","toggleReaction","updateMessage","deleteMessage","onMoveToParentMessage","onHeaderActionClick","isMuted","isChannelFrozen","_k","useState","showRemove","setShowRemove","_l","supposedHover","setSupposedHover","_m","showFileViewer","setShowFileViewer","usingReaction","isSuper","isBroadcast","_o","showEditInput","setShowEditInput","disabled","myRole","Role","OPERATOR","editMessageInputRef","useRef","_p","mentionNickname","setMentionNickname","_q","mentionedUsers","setMentionedUsers","_r","mentionedUserIds","setMentionedUserIds","_s","messageInputEvent","setMessageInputEvent","_t","selectedUser","setSelectedUser","_u","mentionSuggestedUsers","setMentionSuggestedUsers","_v","ableMention","setAbleMention","displaySuggestedMentionList","length","useEffect","maxMentionCount","filter","i","indexOf","splice","avatarRef","_w","useContext","UserProfileContext","disableUserProfile","renderUserProfile","_d","isUserMessage","call","React","__spreadArray","users","maxSuggestionCount","startTyping","messageId","message","mentionTemplate","endTyping","mentionText","userIds","e","key","MessageInputKeys","Enter","ArrowUp","ArrowDown","concat","toggleDropdown","members","find","m","sender","profileUrl","closeDropdown","paddingTop","paddingBottom","close","ConnectedUserProfile","LabelTypography","CAPTION_2","LabelColors","ONBACKGROUND_2","_f","_e","member","nickname","getSenderName","CAPTION_3","format","createdAt","locale","_g","channel","then"],"mappings":"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"}