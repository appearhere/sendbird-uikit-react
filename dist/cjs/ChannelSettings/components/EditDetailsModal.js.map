{"version":3,"file":"EditDetailsModal.js","sources":["../../../../src/smart-components/ChannelSettings/components/EditDetailsModal/index.tsx"],"sourcesContent":["import React, { useState, useRef, useContext } from 'react';\n\nimport { useChannelSettingsContext } from '../../context/ChannelSettingsProvider';\nimport { LocalizationContext } from '../../../../lib/LocalizationContext';\nimport useSendbirdStateContext from '../../../../hooks/useSendbirdStateContext';\n\nimport Modal from '../../../../ui/Modal';\nimport Input, { InputLabel } from '../../../../ui/Input';\nimport Avatar from '../../../../ui/Avatar/index';\nimport { ButtonTypes } from '../../../../ui/Button';\nimport Label, { LabelColors, LabelTypography } from '../../../../ui/Label';\nimport TextButton from '../../../../ui/TextButton';\nimport ChannelAvatar from '../../../../ui/ChannelAvatar/index';\nimport uuidv4 from '../../../../utils/uuid';\n\nexport type EditDetailsProps = {\n  onSubmit: () => void;\n  onCancel: () => void;\n}\n\nconst EditDetails: React.FC<EditDetailsProps> = (props: EditDetailsProps) => {\n  const {\n    onSubmit,\n    onCancel,\n  } = props;\n\n  const {\n    channel,\n    onChannelModified,\n    onBeforeUpdateChannel,\n    setChannelUpdateId,\n  } = useChannelSettingsContext();\n  const title = channel?.name;\n\n  const state = useSendbirdStateContext();\n  const userId = state?.config?.userId;\n  const theme = state?.config?.theme;\n  const logger = state?.config?.logger;\n\n  const inputRef = useRef(null);\n  const formRef = useRef(null);\n  const hiddenInputRef = useRef(null);\n  const [currentImg, setCurrentImg] = useState(null);\n  const [newFile, setNewFile] = useState(null);\n  const { stringSet } = useContext(LocalizationContext);\n\n  return (\n    <Modal\n      isFullScreenOnMobile\n      titleText={stringSet.MODAL__CHANNEL_INFORMATION__TITLE}\n      submitText={stringSet.BUTTON__SAVE}\n      onCancel={onCancel}\n      onSubmit={() => {\n        if (title !== '' && !inputRef.current.value) {\n          if (formRef.current.reportValidity) { // might not work in explorer\n            formRef.current.reportValidity();\n          }\n          return;\n        }\n\n        const currentTitle = inputRef.current.value;\n        const currentImg = newFile;\n        logger.info('ChannelSettings: Channel information being updated', {\n          currentTitle,\n          currentImg,\n        });\n        if (onBeforeUpdateChannel) {\n          logger.info('ChannelSettings: onBeforeUpdateChannel');\n          const params = onBeforeUpdateChannel(currentTitle, currentImg, channel?.data);\n          channel?.updateChannel(params).then((groupChannel) => {\n            onChannelModified?.(groupChannel);\n            setChannelUpdateId(uuidv4());\n            onSubmit();\n          });\n        } else {\n          logger.info('ChannelSettings: normal');\n          channel?.updateChannel({\n            coverImage: currentImg,\n            name: currentTitle,\n            data: channel?.data || '',\n          }).then((groupChannel) => {\n            logger.info('ChannelSettings: Channel information updated', groupChannel);\n            onChannelModified?.(groupChannel);\n            setChannelUpdateId(uuidv4());\n            onSubmit();\n          });\n        }\n      }}\n      type={ButtonTypes.PRIMARY}\n    >\n      <form\n        className=\"channel-profile-form\"\n        ref={formRef}\n        onSubmit={(e) => { e.preventDefault(); }}\n      >\n        <div className=\"channel-profile-form__img-section\">\n          <InputLabel>\n            {stringSet.MODAL__CHANNEL_INFORMATION__CHANNEL_IMAGE}\n          </InputLabel>\n          <div className=\"channel-profile-form__avatar\">\n            {\n              currentImg\n                ? (\n                  <Avatar\n                    height=\"80px\"\n                    width=\"80px\"\n                    src={currentImg}\n                  />\n                ) : (\n                  <ChannelAvatar\n                    height={80}\n                    width={80}\n                    channel={channel}\n                    userId={userId}\n                    theme={theme}\n                  />\n                )\n              }\n          </div>\n          <input\n            ref={hiddenInputRef}\n            type=\"file\"\n            accept=\"image/gif, image/jpeg, image/png\"\n            style={{ display: 'none' }}\n            onChange={(e) => {\n              setCurrentImg(URL.createObjectURL(e.target.files[0]));\n              setNewFile(e.target.files[0]);\n              hiddenInputRef.current.value = '';\n            }}\n          />\n          <TextButton\n            className=\"channel-profile-form__avatar-button\"\n            onClick={() => hiddenInputRef.current.click()}\n            disableUnderline\n          >\n            <Label type={LabelTypography.BUTTON_1} color={LabelColors.PRIMARY}>\n              {stringSet.MODAL__CHANNEL_INFORMATION__UPLOAD}\n            </Label>\n          </TextButton>\n        </div>\n        <div className=\"channel-profile-form__name-section\">\n          <InputLabel>\n            {stringSet.MODAL__CHANNEL_INFORMATION__CHANNEL_NAME}\n          </InputLabel>\n          <Input\n            required={title !== ''}\n            name=\"channel-profile-form__name\"\n            ref={inputRef}\n            value={title}\n            placeHolder={stringSet.MODAL__CHANNEL_INFORMATION__INPUT__PLACE_HOLDER}\n          />\n        </div>\n      </form>\n    </Modal>\n  );\n};\n\nexport default EditDetails;\n"],"names":["EditDetails","props","onSubmit","onCancel","_d","useChannelSettingsContext","channel","onChannelModified","onBeforeUpdateChannel","setChannelUpdateId","title","name","state","useSendbirdStateContext","userId","_a","config","theme","_b","logger","_c","inputRef","useRef","formRef","hiddenInputRef","_e","useState","currentImg","setCurrentImg","_f","newFile","setNewFile","stringSet","useContext","LocalizationContext","React","Modal","MODAL__CHANNEL_INFORMATION__TITLE","BUTTON__SAVE","current","value","reportValidity","currentTitle","info","params","data","updateChannel","then","groupChannel","uuidv4","coverImage","ButtonTypes","PRIMARY","e","preventDefault","InputLabel","MODAL__CHANNEL_INFORMATION__CHANNEL_IMAGE","Avatar","ChannelAvatar","display","URL","createObjectURL","target","files","TextButton","click","Label","LabelTypography","BUTTON_1","LabelColors","MODAL__CHANNEL_INFORMATION__UPLOAD","MODAL__CHANNEL_INFORMATION__CHANNEL_NAME","Input","MODAL__CHANNEL_INFORMATION__INPUT__PLACE_HOLDER"],"mappings":"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"}