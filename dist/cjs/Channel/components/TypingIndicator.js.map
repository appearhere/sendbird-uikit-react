{"version":3,"file":"TypingIndicator.js","sources":["../../../../src/smart-components/Channel/components/TypingIndicator.tsx"],"sourcesContent":["import React, { useEffect, useState, useContext } from 'react';\nimport {\n  GroupChannelHandler,\n  Member,\n  SendbirdGroupChat,\n} from '@sendbird/chat/groupChannel';\n\nimport { LocalizationContext } from '../../../lib/LocalizationContext';\nimport { uuidv4 } from '../../../utils/uuid';\nimport Label, { LabelTypography, LabelColors } from '../../../ui/Label';\nimport { useChannelContext } from '../context/ChannelProvider';\nimport useSendbirdStateContext from '../../../hooks/useSendbirdStateContext';\n\nexport interface TypingIndicatorTextProps {\n  members: Member[];\n}\n\nexport const TypingIndicatorText: React.FC<TypingIndicatorTextProps> = ({ members }: TypingIndicatorTextProps) => {\n  const { stringSet } = useContext(LocalizationContext);\n  if (!members || members.length === 0) {\n    return '';\n  }\n\n  if (members && members.length === 1) {\n    return `${members[0].nickname} ${stringSet.TYPING_INDICATOR__IS_TYPING}`;\n  }\n\n  if (members && members.length === 2) {\n    return `${members[0].nickname} ${stringSet.TYPING_INDICATOR__AND} ${members[1].nickname} ${stringSet.TYPING_INDICATOR__ARE_TYPING}`;\n  }\n\n  return stringSet.TYPING_INDICATOR__MULTIPLE_TYPING;\n};\n\nconst TypingIndicator: React.FC = () => {\n  const { channelUrl } = useChannelContext();\n  const globalStore = useSendbirdStateContext();\n  const sb = globalStore?.stores?.sdkStore?.sdk as SendbirdGroupChat;\n  const logger = globalStore?.config?.logger;\n  const [handlerId, setHandlerId] = useState(uuidv4());\n  const [typingMembers, setTypingMembers] = useState<Member[]>([]);\n\n  useEffect(() => {\n    if (sb?.groupChannel?.addGroupChannelHandler) {\n      sb.groupChannel.removeGroupChannelHandler(handlerId);\n      const newHandlerId = uuidv4();\n      const handler = new GroupChannelHandler({\n        onTypingStatusUpdated: (groupChannel) => {\n          // there is a possible warning in here - setState called after unmount\n          logger.info('Channel > Typing Indicator: onTypingStatusUpdated', groupChannel);\n          if (groupChannel.url === channelUrl) {\n            const members = groupChannel.getTypingUsers();\n            setTypingMembers(members);\n          }\n        }\n      });\n      sb.groupChannel.addGroupChannelHandler(newHandlerId, handler);\n      setHandlerId(newHandlerId);\n    }\n\n    return () => {\n      setTypingMembers([]);\n      if (sb?.groupChannel?.removeGroupChannelHandler) {\n        sb.groupChannel.removeGroupChannelHandler(handlerId);\n      }\n    };\n  }, [channelUrl]);\n\n  return (\n    <Label\n      className=\"sendbird-conversation__footer__typing-indicator__text\"\n      type={LabelTypography.CAPTION_2}\n      color={LabelColors.ONBACKGROUND_2}\n    >\n      <TypingIndicatorText members={typingMembers} />\n    </Label>\n  );\n}\n\nexport default TypingIndicator;\n"],"names":["TypingIndicatorText","_a","members","stringSet","useContext","LocalizationContext","length","concat","nickname","TYPING_INDICATOR__IS_TYPING","TYPING_INDICATOR__AND","TYPING_INDICATOR__ARE_TYPING","TYPING_INDICATOR__MULTIPLE_TYPING","TypingIndicator","channelUrl","useChannelContext","globalStore","useSendbirdStateContext","sb","_b","stores","sdkStore","sdk","logger","_c","config","_d","useState","uuidv4","handlerId","setHandlerId","_e","typingMembers","setTypingMembers","useEffect","groupChannel","addGroupChannelHandler","removeGroupChannelHandler","newHandlerId","handler","GroupChannelHandler","onTypingStatusUpdated","info","url","getTypingUsers","React","Label","LabelTypography","CAPTION_2","LabelColors","ONBACKGROUND_2"],"mappings":"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"}