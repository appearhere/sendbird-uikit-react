{"version":3,"file":"ContextMenu.js","sources":["../../../src/ui/ContextMenu/MenuItems.tsx","../../../src/ui/ContextMenu/EmojiListItems.tsx","../../../src/ui/ContextMenu/index.tsx"],"sourcesContent":["import React, { ReactElement } from 'react';\nimport { createPortal } from 'react-dom';\n\ninterface MenuItemsProps {\n  className?: string;\n  style?: Record<string, string>;\n  openLeft?: boolean;\n  children: React.ReactElement | Array<React.ReactElement>;\n  parentRef: React.RefObject<HTMLElement>;\n  parentContainRef: React.RefObject<HTMLElement>;\n  closeDropdown: () => void;\n}\n\ntype MenuStyleType = { top?: number, left?: number };\ninterface MenuItemsState {\n  menuStyle: MenuStyleType;\n  handleClickOutside: (e: MouseEvent) => void;\n}\n\nexport default class MenuItems extends React.Component<MenuItemsProps, MenuItemsState> {\n  constructor(props: MenuItemsProps) {\n    super(props);\n    this.state = {\n      menuStyle: {},\n      handleClickOutside: () => {/* noop */ },\n    };\n  }\n  menuRef: React.RefObject<HTMLUListElement> = React.createRef();\n\n  componentDidMount(): void {\n    this.setupEvents();\n    this.getMenuPosition();\n  }\n\n  componentWillUnmount(): void {\n    this.cleanUpEvents();\n  }\n\n  setupEvents = (): void => {\n    const { closeDropdown } = this.props;\n    const { menuRef } = this;\n    const handleClickOutside = (event) => {\n      if (menuRef?.current && !menuRef?.current?.contains?.(event.target)) {\n        closeDropdown?.();\n      }\n    };\n    this.setState({\n      handleClickOutside,\n    });\n\n    document.addEventListener('mousedown', handleClickOutside);\n  }\n\n  cleanUpEvents = (): void => {\n    const {\n      handleClickOutside,\n    } = this.state;\n    document.removeEventListener('mousedown', handleClickOutside);\n  }\n\n  getMenuPosition = (): MenuStyleType => {\n    const { parentRef, openLeft } = this.props;\n    const parentRect = parentRef?.current?.getBoundingClientRect?.();\n    const x = parentRect?.x || parentRect?.left || 0;\n    const y = parentRect?.y || parentRect?.top || 0;\n    const menuStyle = {\n      top: y,\n      left: x,\n    };\n    if (!this.menuRef.current) return menuStyle;\n    const { innerWidth, innerHeight } = window;\n    const rect = this.menuRef.current.getBoundingClientRect();\n    if (y + rect.height > innerHeight) {\n      menuStyle.top -= rect.height;\n    }\n    if (x + rect.width > innerWidth && !openLeft) {\n      menuStyle.left -= rect.width;\n    }\n    if (menuStyle.top < 0) {\n      menuStyle.top = rect.height < innerHeight ? (innerHeight - rect.height) / 2 : 0;\n    }\n    if (menuStyle.left < 0) {\n      menuStyle.left = rect.width < innerWidth ? (innerWidth - rect.width) / 2 : 0;\n    }\n    menuStyle.top += 32;\n    if (openLeft) {\n      const padding = Number.isNaN(rect.width - 30)\n        ? 108 // default\n        : rect.width - 30;\n      menuStyle.left -= padding;\n    }\n    this.setState({ menuStyle })\n    return menuStyle;\n  }\n\n  render(): ReactElement {\n    const { menuStyle } = this.state;\n    const { children, style, className=\"\" } = this.props;\n    return (\n      createPortal(\n        (\n          <div className={this.props?.className}>\n            <div className=\"sendbird-dropdown__menu-backdrop\" />\n            <ul\n              className={`${className} sendbird-dropdown__menu`}\n              ref={this.menuRef}\n              style={{\n                display: 'inline-block',\n                position: 'fixed',\n                left: `${Math.round(menuStyle.left)}px`,\n                top: `${Math.round(menuStyle.top)}px`,\n                ...style,\n              }}\n            >\n              {children}\n            </ul>\n          </div>\n        ),\n        document.getElementById('sendbird-dropdown-portal'),\n      )\n    );\n  }\n}\n","import React, { ReactElement, ReactNode, RefObject, useEffect, useRef, useState } from 'react';\nimport { createPortal } from 'react-dom';\n\nimport SortByRow from '../SortByRow';\n\ntype SpaceFromTrigger = { x: number, y: number };\ntype ReactionStyle = { left: number, top: number };\nexport interface EmojiListItemsProps {\n  closeDropdown: () => void;\n  children: ReactNode;\n  parentRef: RefObject<HTMLDivElement>;\n  parentContainRef: RefObject<HTMLDivElement>;\n  spaceFromTrigger?: SpaceFromTrigger;\n}\n\nconst EmojiListItems = ({\n  children,\n  parentRef,\n  parentContainRef,\n  spaceFromTrigger = { x: 0, y: 0 },\n  closeDropdown,\n}: EmojiListItemsProps): ReactElement => {\n  const [reactionStyle, setReactionStyle] = useState<ReactionStyle>({ left: 0, top: 0 });\n  const reactionRef = useRef(null);\n\n  /* showParent & hideParent */\n  useEffect(() => {\n    if (parentContainRef && parentContainRef?.current) {\n      parentContainRef.current.classList.add('sendbird-reactions--pressed');\n    }\n    return () => {\n      if (parentContainRef && parentContainRef?.current) {\n        parentContainRef.current.classList.remove('sendbird-reactions--pressed');\n      }\n    };\n  }, []);\n\n  /* setupEvents & cleanupEvents */\n  useEffect(() => {\n    const handleClickOutSide = (event) => {\n      if (reactionRef?.current && !reactionRef?.current?.contains?.(event.target)) {\n        closeDropdown();\n      }\n    };\n    document.addEventListener('mousedown', handleClickOutSide);\n    return () => {\n      document.removeEventListener('mousedown', handleClickOutSide);\n    };\n  }, []);\n\n  /* getBarPosition */\n  useEffect(() => {\n    const spaceFromTriggerX = spaceFromTrigger?.x || 0;\n    const spaceFromTriggerY = spaceFromTrigger?.y || 0;\n    const parentRect = parentRef?.current?.getBoundingClientRect();\n    const x = parentRect.x || parentRect.left;\n    const y = parentRect.y || parentRect.top;\n    const reactionStyle = {\n      top: y,\n      left: x,\n    };\n    if (!reactionRef?.current) {\n      setReactionStyle(reactionStyle);\n    } else {\n      const rect = reactionRef?.current?.getBoundingClientRect();\n      if (reactionStyle.top < rect.height) {\n        reactionStyle.top += parentRect.height;\n        reactionStyle.top += spaceFromTriggerY;\n      } else {\n        reactionStyle.top -= rect.height;\n        reactionStyle.top -= spaceFromTriggerY;\n      }\n      reactionStyle.left -= rect.width / 2;\n      reactionStyle.left += (parentRect.height / 2) - 2;\n      reactionStyle.left += spaceFromTriggerX;\n      const maximumLeft = window.innerWidth - rect.width;\n      if (maximumLeft < reactionStyle.left) {\n        reactionStyle.left = maximumLeft;\n      }\n      if (reactionStyle.left < 0) {\n        reactionStyle.left = 0;\n      }\n      setReactionStyle(reactionStyle);\n    }\n  }, []);\n\n  return (\n    createPortal(\n      <>\n        <div className=\"sendbird-dropdown__menu-backdrop\" />\n        <ul\n          className=\"sendbird-dropdown__reaction-bar\"\n          ref={reactionRef}\n          style={{\n            display: 'inline-block',\n            position: 'fixed',\n            left: `${Math.round(reactionStyle.left)}px`,\n            top: `${Math.round(reactionStyle.top)}px`,\n          }}\n        >\n          <SortByRow\n            className=\"sendbird-dropdown__reaction-bar__row\"\n            maxItemCount={8}\n            itemWidth={44}\n            itemHeight={40}\n          >\n            {children}\n          </SortByRow>\n        </ul>\n      </>,\n      document.getElementById('sendbird-emoji-list-portal'),\n    )\n  );\n};\n\nexport default EmojiListItems;\n","import React, { ReactElement, MouseEvent, useState, ReactNode } from 'react';\nimport './index.scss';\n\nimport _MenuItems from './MenuItems';\nimport _EmojiListItems from './EmojiListItems';\n\nimport { getClassName } from '../../utils';\nimport Label, { LabelTypography, LabelColors } from '../Label';\n\nconst ENTER_KEY = 13;\n\nexport const MenuItems = _MenuItems;\nexport const EmojiListItems = _EmojiListItems;\n\nexport interface MenuItemProps {\n  className?: string | Array<string>;\n  children: ReactElement | ReactElement[] | ReactNode;\n  onClick?: (e: MouseEvent<HTMLLIElement>) => void;\n  disable?: boolean;\n}\nexport const MenuItem = ({\n  className = '',\n  children,\n  onClick,\n  disable = false,\n}: MenuItemProps): ReactElement => {\n  const handleClickEvent = (e) => {\n    if (!disable && onClick) {\n      onClick?.(e);\n    }\n  };\n  return (\n    <li\n      className={getClassName([className, 'sendbird-dropdown__menu-item', disable ? 'disable' : ''])}\n      role=\"menuitem\"\n      aria-disabled={disable ? true : false}\n      onClick={handleClickEvent}\n      onKeyPress={(e) => { if (e.keyCode === ENTER_KEY) handleClickEvent(e); }}\n      tabIndex={0}\n    >\n      <Label\n        className=\"sendbird-dropdown__menu-item__text\"\n        type={LabelTypography.SUBTITLE_2}\n        color={disable ? LabelColors.ONBACKGROUND_4 : LabelColors.ONBACKGROUND_1}\n      >\n        {children}\n      </Label>\n    </li>\n  );\n};\n\nexport const MenuRoot = (): ReactElement => (\n  <div\n    id=\"sendbird-dropdown-portal\"\n    className=\"sendbird-dropdown-portal\"\n  />\n);\nexport const EmojiReactionListRoot = (): ReactElement => <div id=\"sendbird-emoji-list-portal\" />;\n\ntype MenuDisplayingFunc = () => void;\nexport interface ContextMenuProps {\n  menuTrigger?: (MenuDisplayingFunc) => ReactElement;\n  menuItems: (MenuDisplayingFunc) => ReactElement;\n  isOpen?: boolean;\n}\nexport default function ContextMenu({\n  menuTrigger,\n  menuItems,\n  isOpen,\n}: ContextMenuProps): ReactElement {\n  const [showMenu, setShowMenu] = useState(false);\n  return (\n    <div\n      className=\"sendbird-context-menu\"\n      style={{ display: 'inline' }}\n    >\n      {menuTrigger?.(() => setShowMenu(!showMenu))}\n      {(showMenu || isOpen) && menuItems(() => setShowMenu(false))}\n    </div>\n  );\n}\n"],"names":["MenuItems","_super","__extends","props","_this","call","menuRef","React","createRef","setupEvents","closeDropdown","handleClickOutside","event","current","_b","_a","contains","target","setState","document","addEventListener","cleanUpEvents","state","removeEventListener","getMenuPosition","_c","parentRef","openLeft","parentRect","getBoundingClientRect","x","left","y","top","menuStyle","innerWidth","window","innerHeight","rect","height","width","padding","Number","isNaN","prototype","componentDidMount","componentWillUnmount","render","children","style","className","createPortal","concat","__assign","display","position","Math","round","getElementById","Component","EmojiListItems","parentContainRef","spaceFromTrigger","useState","reactionStyle","setReactionStyle","reactionRef","useRef","useEffect","classList","add","remove","handleClickOutSide","spaceFromTriggerX","spaceFromTriggerY","maximumLeft","SortByRow","ENTER_KEY","_MenuItems","_EmojiListItems","MenuItem","onClick","disable","handleClickEvent","e","getClassName","keyCode","Label","LabelTypography","SUBTITLE_2","LabelColors","ONBACKGROUND_4","ONBACKGROUND_1","MenuRoot","EmojiReactionListRoot","ContextMenu","menuTrigger","menuItems","isOpen","showMenu","setShowMenu"],"mappings":"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"}