{"version":3,"file":"EditDetailsModal.js","sources":["../../../../src/smart-components/OpenChannelSettings/components/EditDetailsModal.tsx"],"sourcesContent":["import React, {\n  useState,\n  useRef,\n  useContext,\n  ReactElement,\n} from 'react';\nimport { OpenChannelUpdateParams } from '@sendbird/chat/openChannel';\n\nimport { LocalizationContext } from '../../../lib/LocalizationContext';\nimport * as pubSubTopics from '../../../lib/pubSub/topics';\nimport Modal from '../../../ui/Modal';\nimport Input, { InputLabel } from '../../../ui/Input';\nimport Avatar from '../../../ui/Avatar/index';\nimport { ButtonTypes } from '../../../ui/Button';\nimport Label, { LabelColors, LabelTypography } from '../../../ui/Label';\nimport TextButton from '../../../ui/TextButton';\nimport OpenChannelAvatar from '../../../ui/ChannelAvatar/OpenChannelAvatar';\nimport { useOpenChannelSettingsContext } from '../context/OpenChannelSettingsProvider';\nimport useSendbirdStateContext from '../../../hooks/useSendbirdStateContext';\n\ninterface Props {\n  onCancel(): void;\n}\n\nconst EditDetails = (props: Props): ReactElement => {\n  const {\n    onCancel,\n  } = props;\n  const globalState = useSendbirdStateContext();\n  const { logger, theme, pubSub } = globalState?.config;\n  const {\n    channel,\n    onBeforeUpdateChannel,\n    onChannelModified,\n    setChannel,\n  } = useOpenChannelSettingsContext();\n\n  const inputRef = useRef(null);\n  const formRef = useRef(null);\n  const hiddenInputRef = useRef(null);\n  const [currentImg, setCurrentImg] = useState(null);\n  const [newFile, setNewFile] = useState(null);\n  const { stringSet } = useContext(LocalizationContext);\n  const title = channel?.name;\n  return (\n    <Modal\n      isFullScreenOnMobile\n      titleText={stringSet.MODAL__CHANNEL_INFORMATION__TITLE}\n      submitText={stringSet.BUTTON__SAVE}\n      onCancel={onCancel}\n      onSubmit={() => {\n        if (title !== '' && !inputRef.current.value) {\n          if (formRef.current.reportValidity) { // might not work in explorer\n            formRef.current.reportValidity();\n          }\n          return;\n        }\n        const currentTitle = inputRef.current.value;\n        const currentImg = newFile;\n        logger.info('ChannelSettings: Channel information being updated');\n        const params: OpenChannelUpdateParams = onBeforeUpdateChannel\n          ? onBeforeUpdateChannel(currentTitle, currentImg, channel?.data)\n          : {\n            name: currentTitle,\n            coverUrlOrImage: currentImg,\n            data: channel?.data,\n          };\n        logger.info('ChannelSettings: Updating channel information', params);\n        channel?.updateChannel(params)\n          .then((updatedChannel) => {\n            logger.info('ChannelSettings: Channel information update succeeded', updatedChannel);\n            onChannelModified?.(updatedChannel);\n            setChannel(updatedChannel);\n            pubSub?.publish(pubSubTopics.UPDATE_OPEN_CHANNEL, updatedChannel);\n          })\n          .catch((error) => {\n            logger.error('ChannelSettings: Channel infomation update failed', error);\n            setChannel(null);\n          });\n        onCancel();\n      }}\n      type={ButtonTypes.PRIMARY}\n    >\n      <form\n        className=\"channel-profile-form\"\n        ref={formRef}\n        onSubmit={(e) => { e.preventDefault(); }}\n      >\n        <div className=\"channel-profile-form__img-section\">\n          <InputLabel>\n            {stringSet.MODAL__CHANNEL_INFORMATION__CHANNEL_IMAGE}\n          </InputLabel>\n          <div className=\"channel-profile-form__avatar\">\n            {\n              currentImg\n                ? (\n                  <Avatar\n                    height=\"80px\"\n                    width=\"80px\"\n                    src={currentImg}\n                  />\n                ) : (\n                  <OpenChannelAvatar\n                    height={80}\n                    width={80}\n                    channel={channel}\n                    theme={theme}\n                  />\n                )\n            }\n          </div>\n          <input\n            ref={hiddenInputRef}\n            type=\"file\"\n            accept=\"image/gif, image/jpeg, image/png\"\n            style={{ display: 'none' }}\n            onChange={(e) => {\n              setCurrentImg(URL.createObjectURL(e.target.files[0]));\n              setNewFile(e.target.files[0]);\n              hiddenInputRef.current.value = '';\n            }}\n          />\n          <TextButton\n            className=\"channel-profile-form__avatar-button\"\n            onClick={() => hiddenInputRef.current.click()}\n            disableUnderline\n          >\n            <Label type={LabelTypography.BUTTON_1} color={LabelColors.PRIMARY}>\n              {stringSet.MODAL__CHANNEL_INFORMATION__UPLOAD}\n            </Label>\n          </TextButton>\n        </div>\n        <div className=\"channel-profile-form__name-section\">\n          <InputLabel>\n            {stringSet.MODAL__CHANNEL_INFORMATION__CHANNEL_NAME}\n          </InputLabel>\n          <Input\n            required={title !== ''}\n            name=\"channel-profile-form__name\"\n            ref={inputRef}\n            value={title}\n            placeHolder={stringSet.MODAL__CHANNEL_INFORMATION__INPUT__PLACE_HOLDER}\n          />\n        </div>\n      </form>\n    </Modal>\n  );\n};\n\nexport default EditDetails;\n"],"names":["EditDetails","props","onCancel","globalState","useSendbirdStateContext","_a","config","logger","theme","pubSub","_b","useOpenChannelSettingsContext","channel","onBeforeUpdateChannel","onChannelModified","setChannel","inputRef","useRef","formRef","hiddenInputRef","_c","useState","currentImg","setCurrentImg","_d","newFile","setNewFile","stringSet","useContext","LocalizationContext","title","name","React","Modal","MODAL__CHANNEL_INFORMATION__TITLE","BUTTON__SAVE","current","value","reportValidity","currentTitle","info","params","data","coverUrlOrImage","updateChannel","then","updatedChannel","publish","pubSubTopics","catch","error","ButtonTypes","PRIMARY","e","preventDefault","InputLabel","MODAL__CHANNEL_INFORMATION__CHANNEL_IMAGE","Avatar","OpenChannelAvatar","display","URL","createObjectURL","target","files","TextButton","click","Label","LabelTypography","BUTTON_1","LabelColors","MODAL__CHANNEL_INFORMATION__UPLOAD","MODAL__CHANNEL_INFORMATION__CHANNEL_NAME","Input","MODAL__CHANNEL_INFORMATION__INPUT__PLACE_HOLDER"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwBA,IAAMA,WAAW,GAAG,UAACC,KAAD,EAAa;AAE7B,EAAA,IAAAC,QAAQ,GACND,KAAK,CAAAC,QADP,CAAA;EAEF,IAAMC,WAAW,GAAGC,uBAAuB,EAA3C,CAAA;;AACM,EAAA,IAAAC,KAA4BF,WAAW,KAAA,IAAX,IAAAA,WAAW,KAAA,KAAA,CAAX,GAAW,KAAA,CAAX,GAAAA,WAAW,CAAEG,MAAzC;AAAA,MAAEC,MAAM,YAAR;AAAA,MAAUC,KAAK,WAAf;AAAA,MAAiBC,MAAM,YAAvB,CAAA;;EACA,IAAAC,EAKF,GAAAC,yDAA6B,EAL3B;AAAA,MACJC,OAAO,GAAAF,EAAA,CAAAE,OADH;AAAA,MAEJC,qBAAqB,GAAAH,EAAA,CAAAG,qBAFjB;AAAA,MAGJC,iBAAiB,GAAAJ,EAAA,CAAAI,iBAHb;AAAA,MAIJC,UAAU,gBAJN,CAAA;;AAON,EAAA,IAAMC,QAAQ,GAAGC,YAAM,CAAC,IAAD,CAAvB,CAAA;AACA,EAAA,IAAMC,OAAO,GAAGD,YAAM,CAAC,IAAD,CAAtB,CAAA;AACA,EAAA,IAAME,cAAc,GAAGF,YAAM,CAAC,IAAD,CAA7B,CAAA;;AACM,EAAA,IAAAG,EAAA,GAA8BC,cAAQ,CAAC,IAAD,CAAtC;AAAA,MAACC,UAAU,GAAAF,EAAA,CAAA,CAAA,CAAX;AAAA,MAAaG,aAAa,GAAAH,EAAA,CAAA,CAAA,CAA1B,CAAA;;AACA,EAAA,IAAAI,EAAA,GAAwBH,cAAQ,CAAC,IAAD,CAAhC;AAAA,MAACI,OAAO,GAAAD,EAAA,CAAA,CAAA,CAAR;AAAA,MAAUE,UAAU,GAAAF,EAAA,CAAA,CAAA,CAApB,CAAA;;AACE,EAAA,IAAAG,SAAS,GAAKC,gBAAU,CAACC,uCAAD,CAAV,UAAd,CAAA;AACR,EAAA,IAAMC,KAAK,GAAGlB,OAAO,KAAA,IAAP,IAAAA,OAAO,KAAP,KAAA,CAAA,GAAA,KAAA,CAAA,GAAAA,OAAO,CAAEmB,IAAvB,CAAA;AACA,EAAA,oBACEC,wCAACC,mBAAD,EAAA;AACE,IAAA,oBAAoB,EADtB,IAAA;IAEE,SAAS,EAAEN,SAAS,CAACO,iCAFvB;IAGE,UAAU,EAAEP,SAAS,CAACQ,YAHxB;AAIE,IAAA,QAAQ,EAAEjC,QAJZ;AAKE,IAAA,QAAQ,EAAE,YAAA;MACR,IAAI4B,KAAK,KAAK,EAAV,IAAgB,CAACd,QAAQ,CAACoB,OAAT,CAAiBC,KAAtC,EAA6C;AAC3C,QAAA,IAAInB,OAAO,CAACkB,OAAR,CAAgBE,cAApB,EAAoC;AAAE;UACpCpB,OAAO,CAACkB,OAAR,CAAgBE,cAAhB,EAAA,CAAA;AACD,SAAA;;AACD,QAAA,OAAA;AACD,OAAA;;AACD,MAAA,IAAMC,YAAY,GAAGvB,QAAQ,CAACoB,OAAT,CAAiBC,KAAtC,CAAA;MACA,IAAMf,UAAU,GAAGG,OAAnB,CAAA;MACAlB,MAAM,CAACiC,IAAP,CAAY,oDAAZ,CAAA,CAAA;MACA,IAAMC,MAAM,GAA4B5B,qBAAqB,GACzDA,qBAAqB,CAAC0B,YAAD,EAAejB,UAAf,EAA2BV,OAAO,KAAA,IAAP,IAAAA,OAAO,KAAA,KAAA,CAAP,GAAO,KAAA,CAAP,GAAAA,OAAO,CAAE8B,IAApC,CADoC,GAEzD;AACAX,QAAAA,IAAI,EAAEQ,YADN;AAEAI,QAAAA,eAAe,EAAErB,UAFjB;AAGAoB,QAAAA,IAAI,EAAE9B,OAAO,KAAA,IAAP,IAAAA,OAAO,KAAP,KAAA,CAAA,GAAA,KAAA,CAAA,GAAAA,OAAO,CAAE8B,IAAAA;OALnB,CAAA;AAOAnC,MAAAA,MAAM,CAACiC,IAAP,CAAY,+CAAZ,EAA6DC,MAA7D,CAAA,CAAA;MACA7B,OAAO,KAAP,IAAA,IAAAA,OAAO,KAAP,KAAA,CAAA,GAAA,KAAA,CAAA,GAAAA,OAAO,CAAEgC,aAAT,CAAuBH,MAAvB,EACGI,IADH,CACQ,UAACC,cAAD,EAAe;AACnBvC,QAAAA,MAAM,CAACiC,IAAP,CAAY,uDAAZ,EAAqEM,cAArE,CAAA,CAAA;AACAhC,QAAAA,iBAAiB,SAAjB,IAAAA,iBAAiB,KAAA,KAAA,CAAjB,GAAiB,KAAA,CAAjB,GAAAA,iBAAiB,CAAGgC,cAAH,CAAjB,CAAA;QACA/B,UAAU,CAAC+B,cAAD,CAAV,CAAA;QACArC,MAAM,KAAN,IAAA,IAAAA,MAAM,KAAN,KAAA,CAAA,GAAA,KAAA,CAAA,GAAAA,MAAM,CAAEsC,OAAR,CAAgBC,0BAAhB,EAAkDF,cAAlD,CAAA,CAAA;AACD,OANH,CAOGG,CAAAA,KAPH,CAOS,UAACC,KAAD,EAAM;AACX3C,QAAAA,MAAM,CAAC2C,KAAP,CAAa,mDAAb,EAAkEA,KAAlE,CAAA,CAAA;QACAnC,UAAU,CAAC,IAAD,CAAV,CAAA;AACD,OAVH,CAAA,CAAA;MAWAb,QAAQ,EAAA,CAAA;KAlCZ;IAoCE,IAAI,EAAEiD,qBAAW,CAACC,OAAAA;GAElB,eAAApB,yBAAA,CAAA,aAAA,CAAA,MAAA,EAAA;AACE,IAAA,SAAS,EAAC,sBADZ;AAEE,IAAA,GAAG,EAAEd,OAFP;IAGE,QAAQ,EAAE,UAACmC,CAAD,EAAE;AAAOA,MAAAA,CAAC,CAACC,cAAF,EAAA,CAAA;AAAqB,KAAA;GAExC,eAAAtB,yBAAA,CAAA,aAAA,CAAA,KAAA,EAAA;AAAK,IAAA,SAAS,EAAC,mCAAA;AAAf,GAAA,eACEA,wCAACuB,mBAAD,EAAA,IAAA,EACG5B,SAAS,CAAC6B,yCADb,CADF,eAIExB,yBAAA,CAAA,aAAA,CAAA,KAAA,EAAA;AAAK,IAAA,SAAS,EAAC,8BAAA;GAEXV,EAAAA,UAAU,gBAENU,yBAAA,CAAA,aAAA,CAACyB,oBAAD,EAAA;AACE,IAAA,MAAM,EAAC,MADT;AAEE,IAAA,KAAK,EAAC,MAFR;AAGE,IAAA,GAAG,EAAEnC,UAAAA;GALD,CAAA,gBAQNU,wCAAC0B,oBAAD,EAAA;AACE,IAAA,MAAM,EAAE,EADV;AAEE,IAAA,KAAK,EAAE,EAFT;AAGE,IAAA,OAAO,EAAE9C,OAHX;AAIE,IAAA,KAAK,EAAEJ,KAAAA;AAJT,GAAA,CAVR,CAJF,eAuBEwB,yBAAA,CAAA,aAAA,CAAA,OAAA,EAAA;AACE,IAAA,GAAG,EAAEb,cADP;AAEE,IAAA,IAAI,EAAC,MAFP;AAGE,IAAA,MAAM,EAAC,kCAHT;AAIE,IAAA,KAAK,EAAE;AAAEwC,MAAAA,OAAO,EAAE,MAAA;KAJpB;IAKE,QAAQ,EAAE,UAACN,CAAD,EAAE;AACV9B,MAAAA,aAAa,CAACqC,GAAG,CAACC,eAAJ,CAAoBR,CAAC,CAACS,MAAF,CAASC,KAAT,CAAe,CAAf,CAApB,CAAD,CAAb,CAAA;MACArC,UAAU,CAAC2B,CAAC,CAACS,MAAF,CAASC,KAAT,CAAe,CAAf,CAAD,CAAV,CAAA;AACA5C,MAAAA,cAAc,CAACiB,OAAf,CAAuBC,KAAvB,GAA+B,EAA/B,CAAA;AACD,KAAA;GAhCL,CAAA,eAkCEL,wCAACgC,aAAD,EAAA;AACE,IAAA,SAAS,EAAC,qCADZ;AAEE,IAAA,OAAO,EAAE,YAAM;AAAA,MAAA,OAAA7C,cAAc,CAACiB,OAAf,CAAuB6B,KAAvB,EAAA,CAAA;KAFjB;IAGE,gBAAgB,EAAA,IAAA;AAHlB,GAAA,eAKEjC,wCAACkC,cAAD,EAAA;IAAO,IAAI,EAAEC,wBAAe,CAACC,QAA7B;IAAuC,KAAK,EAAEC,oBAAW,CAACjB,OAAAA;AAA1D,GAAA,EACGzB,SAAS,CAAC2C,kCADb,CALF,CAlCF,CALF,eAiDEtC,yBAAA,CAAA,aAAA,CAAA,KAAA,EAAA;AAAK,IAAA,SAAS,EAAC,oCAAA;GACb,eAAAA,yBAAA,CAAA,aAAA,CAACuB,mBAAD,EACG5B,IAAAA,EAAAA,SAAS,CAAC4C,wCADb,CADF,eAIEvC,yBAAA,CAAA,aAAA,CAACwC,mBAAD,EAAA;IACE,QAAQ,EAAE1C,KAAK,KAAK,EADtB;AAEE,IAAA,IAAI,EAAC,4BAFP;AAGE,IAAA,GAAG,EAAEd,QAHP;AAIE,IAAA,KAAK,EAAEc,KAJT;IAKE,WAAW,EAAEH,SAAS,CAAC8C,+CAAAA;GAT3B,CAAA,CAjDF,CAtCF,CADF,CAAA;AAuGD;;;;"}